(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-59ce69da"],{"11c1":function(e,t,s){var n=s("c437"),a=s("c64e"),i=a;i.v1=n,i.v4=a,e.exports=i},"1c8b":function(e,t,s){},2366:function(e,t){for(var s=[],n=0;n<256;++n)s[n]=(n+256).toString(16).substr(1);function a(e,t){var n=t||0,a=s;return[a[e[n++]],a[e[n++]],a[e[n++]],a[e[n++]],"-",a[e[n++]],a[e[n++]],"-",a[e[n++]],a[e[n++]],"-",a[e[n++]],a[e[n++]],"-",a[e[n++]],a[e[n++]],a[e[n++]],a[e[n++]],a[e[n++]],a[e[n++]]].join("")}e.exports=a},"90d9":function(e,t,s){"use strict";s("1c8b")},affd:function(e,t,s){},bf48:function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"rwd-container"},[s("div",{staticClass:"container"},[s("div",{staticClass:"navbar"},[s("Navbar")],1),s("div",{staticClass:"chatroom"},[s("ChatPublic")],1)])])},a=[],i=s("d178"),r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"chatroom-container"},[s("div",{staticClass:"dialog-box"},[s("div",{staticClass:"dialog-title"},[e._v("公開聊天室")]),s("div",{staticClass:"dialog-show-box",attrs:{id:"scroll-box"}},e._l(e.message.slice().reverse(),(function(t){return s("div",{key:t.id,class:{"single-message-left":t.User.id!==e.currentUser.id,"single-message-right":t.User.id===e.currentUser.id}},[s("div",{staticClass:"avatar"},[s("img",{attrs:{src:t.User.avatar,alt:""}})]),s("div",{staticClass:"info"},[s("div",{staticClass:"name"},[e._v(e._s(t.User.name))]),s("div",{staticClass:"content"},[s("div",{staticClass:"message"},[e._v(e._s(t.text))]),s("div",{staticClass:"time"},[e._v(e._s(e._f("timeFilter")(t.createdAt)))])])])])})),0),s("div",{staticClass:"send-box"},[s("div",{staticClass:"send-input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.tempMessage,expression:"tempMessage"}],staticClass:"dialog-input",attrs:{type:"text",placeholder:"輸入訊息..."},domProps:{value:e.tempMessage},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.send.apply(null,arguments)},input:function(t){t.target.composing||(e.tempMessage=t.target.value)}}})]),s("div",{staticClass:"send-btn",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.send.apply(null,arguments)}}},[s("img",{attrs:{src:"sendMsg.svg",alt:""}})])])]),s("div",{staticClass:"online-users"},[s("div",{staticClass:"user-top"},[e._v("上線使用者")]),s("div",{staticClass:"user-list"},e._l(e.onlineUser,(function(t){return s("div",{key:t.id,staticClass:"user-card"},[s("div",{staticClass:"user-avatar"},[s("img",{attrs:{src:t.avatar,alt:"avatar"}})]),s("div",{staticClass:"user-info"},[e._v(" "+e._s(t.name)+" "),s("span",[e._v(e._s(t.account))])])])})),0)])])},c=[],o=s("5530"),l=s("1da1"),u=(s("96cf"),s("498a"),s("b0c0"),s("2f62")),d=s("d3cc"),v=s("11c1"),f=s.n(v),g=s("2708"),m=s("c968"),p={name:"ChatPublic",mixins:[g["b"]],data:function(){return{id:1,tempMessage:"",message:[],onlineMessage:"",onlineUser:[]}},sockets:{connect:function(){console.log("socket connected")},disconnect:function(){console.log("socket disconnected")},announce:function(e){this.onlineUser=e.users,this.onlineMessage=e.message},chatMessage:function(e){this.message.unshift(e)},joinPublic:function(){console.log("join!")},leavePublic:function(){console.log("leave!")}},methods:{send:function(){if(this.tempMessage.trim()){var e=new Date,t={id:f()(),text:this.tempMessage,User:{id:this.currentUser.id,name:this.currentUser.name,avatar:this.currentUser.avatar},createdAt:e};this.$socket.emit("chatMessage",t),this.tempMessage=""}},getMessages:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,d["a"].getMessages();case 3:s=t.sent,n=s.data,e.message=n,t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()}},computed:Object(o["a"])({},Object(u["b"])(["currentUser"])),watch:{onlineUser:function(){m["b"].fire({icon:"success",title:this.onlineMessage})}},created:function(){this.$socket.connect(),this.getMessages(),this.$socket.emit("joinPublic")},destroyed:function(){this.$socket.emit("leavePublic")},updated:function(){var e=document.getElementById("scroll-box");e.scrollTop=e.scrollHeight}},h=p,b=(s("90d9"),s("2877")),C=Object(b["a"])(h,r,c,!1,null,"74f0b069",null),y=C.exports,k={name:"ChatRoom",components:{Navbar:i["a"],ChatPublic:y}},w=k,x=(s("d90c"),Object(b["a"])(w,n,a,!1,null,"43e3193c",null));t["default"]=x.exports},c437:function(e,t,s){var n,a,i=s("e1f4"),r=s("2366"),c=0,o=0;function l(e,t,s){var l=t&&s||0,u=t||[];e=e||{};var d=e.node||n,v=void 0!==e.clockseq?e.clockseq:a;if(null==d||null==v){var f=i();null==d&&(d=n=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==v&&(v=a=16383&(f[6]<<8|f[7]))}var g=void 0!==e.msecs?e.msecs:(new Date).getTime(),m=void 0!==e.nsecs?e.nsecs:o+1,p=g-c+(m-o)/1e4;if(p<0&&void 0===e.clockseq&&(v=v+1&16383),(p<0||g>c)&&void 0===e.nsecs&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");c=g,o=m,a=v,g+=122192928e5;var h=(1e4*(268435455&g)+m)%4294967296;u[l++]=h>>>24&255,u[l++]=h>>>16&255,u[l++]=h>>>8&255,u[l++]=255&h;var b=g/4294967296*1e4&268435455;u[l++]=b>>>8&255,u[l++]=255&b,u[l++]=b>>>24&15|16,u[l++]=b>>>16&255,u[l++]=v>>>8|128,u[l++]=255&v;for(var C=0;C<6;++C)u[l+C]=d[C];return t||r(u)}e.exports=l},c64e:function(e,t,s){var n=s("e1f4"),a=s("2366");function i(e,t,s){var i=t&&s||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null),e=e||{};var r=e.random||(e.rng||n)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t)for(var c=0;c<16;++c)t[i+c]=r[c];return t||a(r)}e.exports=i},d3cc:function(e,t,s){"use strict";var n=s("c968");t["a"]={getMessages:function(){return n["c"].get("/chat")},getChatUserList:function(){return n["c"].get("/chat/private")},getChatUserMsg:function(e){var t=e.RoomId;return n["c"].get("/chat/".concat(t))}}},d90c:function(e,t,s){"use strict";s("affd")},e1f4:function(e,t){var s="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(s){var n=new Uint8Array(16);e.exports=function(){return s(n),n}}else{var a=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0===(3&t)&&(e=4294967296*Math.random()),a[t]=e>>>((3&t)<<3)&255;return a}}}}]);
//# sourceMappingURL=chunk-59ce69da.a78c0a6b.js.map