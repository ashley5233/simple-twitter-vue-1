(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-64995860"],{"11c1":function(t,e,s){var a=s("c437"),r=s("c64e"),n=r;n.v1=a,n.v4=r,t.exports=n},2348:function(t,e,s){"use strict";s("c221")},2366:function(t,e){for(var s=[],a=0;a<256;++a)s[a]=(a+256).toString(16).substr(1);function r(t,e){var a=e||0,r=s;return[r[t[a++]],r[t[a++]],r[t[a++]],r[t[a++]],"-",r[t[a++]],r[t[a++]],"-",r[t[a++]],r[t[a++]],"-",r[t[a++]],r[t[a++]],"-",r[t[a++]],r[t[a++]],r[t[a++]],r[t[a++]],r[t[a++]],r[t[a++]]].join("")}t.exports=r},"3b5f":function(t,e,s){"use strict";s("5f93")},"5f93":function(t,e,s){},c221:function(t,e,s){},c437:function(t,e,s){var a,r,n=s("e1f4"),o=s("2366"),i=0,c=0;function u(t,e,s){var u=e&&s||0,l=e||[];t=t||{};var d=t.node||a,v=void 0!==t.clockseq?t.clockseq:r;if(null==d||null==v){var m=n();null==d&&(d=a=[1|m[0],m[1],m[2],m[3],m[4],m[5]]),null==v&&(v=r=16383&(m[6]<<8|m[7]))}var f=void 0!==t.msecs?t.msecs:(new Date).getTime(),p=void 0!==t.nsecs?t.nsecs:c+1,g=f-i+(p-c)/1e4;if(g<0&&void 0===t.clockseq&&(v=v+1&16383),(g<0||f>i)&&void 0===t.nsecs&&(p=0),p>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");i=f,c=p,r=v,f+=122192928e5;var h=(1e4*(268435455&f)+p)%4294967296;l[u++]=h>>>24&255,l[u++]=h>>>16&255,l[u++]=h>>>8&255,l[u++]=255&h;var C=f/4294967296*1e4&268435455;l[u++]=C>>>8&255,l[u++]=255&C,l[u++]=C>>>24&15|16,l[u++]=C>>>16&255,l[u++]=v>>>8|128,l[u++]=255&v;for(var b=0;b<6;++b)l[u+b]=d[b];return e||o(l)}t.exports=u},c64e:function(t,e,s){var a=s("e1f4"),r=s("2366");function n(t,e,s){var n=e&&s||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null),t=t||{};var o=t.random||(t.rng||a)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,e)for(var i=0;i<16;++i)e[n+i]=o[i];return e||r(o)}t.exports=n},d3cc:function(t,e,s){"use strict";var a=s("c968");e["a"]={getMessages:function(){return a["c"].get("/chat")},getChatUserList:function(){return a["c"].get("/chat/private")},getChatUserMsg:function(t){var e=t.RoomId;return a["c"].get("/chat/".concat(e))}}},e19b:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"rwd-container"},[s("div",{staticClass:"container"},[s("div",{staticClass:"navbar"},[s("Navbar")],1),s("div",{staticClass:"chatroom"},[s("ChatPrivate")],1)])])},r=[],n=s("d178"),o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"chatroom-container"},[s("div",{staticClass:"dialog-box"},[s("div",{staticClass:"dialog-title"},[t._v("私人聊天室")]),s("div",{staticClass:"dialog-show-box",attrs:{id:"scroll-box"}},t._l(t.chatMessage.slice().reverse(),(function(e){return s("div",{key:e.id,class:{"single-message-left":e.User.id!==t.currentUser.id,"single-message-right":e.User.id===t.currentUser.id}},[s("div",{staticClass:"avatar"},[s("img",{attrs:{src:e.User.avatar,alt:""}})]),s("div",{staticClass:"info"},[s("div",{staticClass:"name"},[t._v(t._s(e.User.name))]),s("div",{staticClass:"message"},[t._v(t._s(e.text))]),s("div",{staticClass:"time"},[t._v(t._s(t._f("timeFilter")(e.createdAt)))])])])})),0),s("div",{staticClass:"send-box"},[s("div",{staticClass:"send-input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.tempMessage,expression:"tempMessage"}],staticClass:"dialog-input",attrs:{type:"text",placeholder:"輸入訊息..."},domProps:{value:t.tempMessage},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.send.apply(null,arguments)},input:function(e){e.target.composing||(t.tempMessage=e.target.value)}}})]),s("div",{staticClass:"send-btn",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.send.apply(null,arguments)}}},[s("img",{attrs:{src:"sendMsg.svg",alt:""}})])])]),s("div",{staticClass:"online-users"},[s("div",{staticClass:"user-top"},[t._v("訊息")]),s("div",{staticClass:"user-list"},t._l(t.chatUser,(function(e){return s("div",{key:e.id,staticClass:"user-card",on:{click:function(s){return s.stopPropagation(),s.preventDefault(),t.showDialogBox(e.Room.id,e.Room.name)}}},[s("div",{staticClass:"user-avatar"},[s("img",{attrs:{src:e.User.avatar,alt:"avatar"}})]),s("div",{staticClass:"user-info"},[t._v(" "+t._s(e.User.name)+" "),s("span",[t._v(t._s(e.User.account))])])])})),0)])])},i=[],c=s("5530"),u=s("1da1"),l=(s("498a"),s("b0c0"),s("96cf"),s("2f62")),d=s("2708"),v=s("c968"),m=s("d3cc"),f=s("11c1"),p=s.n(f),g={name:"ChatPrivate",mixins:[d["b"]],data:function(){return{chatUser:[],chatMessage:[],tempRoomName:"",tempMessage:""}},methods:{getChatUser:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var s,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m["a"].getChatUserList();case 3:s=e.sent,a=s.data,t.chatUser=a,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()},showDialogBox:function(t,e){var s=this;return Object(u["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,s.$socket.emit("joinRoom",e),a.next=4,m["a"].getChatUserMsg({RoomId:t});case 4:r=a.sent,n=r.data,s.chatMessage=n,s.tempRoomName=e,s.$store.commit("setChatRoomId",t),a.next=14;break;case 11:a.prev=11,a.t0=a["catch"](0),console.log(a.t0);case 14:case"end":return a.stop()}}),a,null,[[0,11]])})))()},send:function(){if(this.tempMessage.trim()){var t=new Date,e={id:p()(),RoomName:this.tempRoomName,RoomId:this.chatRoomId,text:this.tempMessage,User:{id:this.currentUser.id,name:this.currentUser.name,avatar:this.currentUser.avatar},createdAt:t};-1!==e.RoomId?(this.$socket.emit("chatMessage",e),this.tempMessage=""):v["a"].fire({icon:"warning",title:"請選擇聊天室"})}}},sockets:{joinRoom:function(){console.log("join room!")},chatMessage:function(t){console.log(this.chatRoomId),t.RoomId===this.chatRoomId&&this.chatMessage.unshift(t)}},computed:Object(c["a"])(Object(c["a"])({},Object(l["b"])(["chatRoomId"])),Object(l["b"])(["currentUser"])),created:function(){this.getChatUser(),this.$store.commit("setChatRoomId",-1)},updated:function(){var t=document.getElementById("scroll-box");t.scrollTop=t.scrollHeight}},h=g,C=(s("2348"),s("2877")),b=Object(C["a"])(h,o,i,!1,null,"2a20e10f",null),R=b.exports,w={name:"ChatRoom",components:{Navbar:n["a"],ChatPrivate:R}},x=w,y=(s("3b5f"),Object(C["a"])(x,a,r,!1,null,"64dc9fa3",null));e["default"]=y.exports},e1f4:function(t,e){var s="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(s){var a=new Uint8Array(16);t.exports=function(){return s(a),a}}else{var r=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0===(3&e)&&(t=4294967296*Math.random()),r[e]=t>>>((3&e)<<3)&255;return r}}}}]);
//# sourceMappingURL=chunk-64995860.5067bec6.js.map